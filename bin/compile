#!/bin/sh
# bin/compile BUILD_DIR CACHE_DIR ENV_DIR

set -u # stop on unset variables
set -e # stop on error

CACHE_DIR="${2:-}"
EMSDK_DIR="$CACHE_DIR/emsdk"
EMSDK="${EMSDK_DIR}/emsdk"


REPO=https://github.com/emscripten-core/emsdk

echo "-----> Installing Emscripten"

echo "Clonning Emscripten from the repo $REPO"
if [ ! -d "$EMSDK_DIR" ]; then
	git clone "$REPO" "$EMSDK_DIR"
fi

echo "Downloading latest SDK"
"$EMSDK" install latest
"$EMSDK" activate latest

source "$EMSDK_DIR/emsdk_env.sh"
